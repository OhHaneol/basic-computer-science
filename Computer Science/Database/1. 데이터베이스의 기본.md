# 4.1 데이터베이스의 기본

## **개요**
데이터베이스의 엔터티 및 테이블 구조에 대해서 알아봅니다.


## **목차**

<!-- TOC -->

- [데이터베이스의 기본](#%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4%EC%9D%98-%EA%B8%B0%EB%B3%B8)
    - [**개요**](#%EA%B0%9C%EC%9A%94)
    - [**목차**](#%EB%AA%A9%EC%B0%A8)
    - [데이터베이스](#%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4)
        - [DBMSDataBase](#dbmsdatabase)
        - [데이터베이스와 DBMS의 구조](#%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4%EC%99%80-dbms%EC%9D%98-%EA%B5%AC%EC%A1%B0)
    - [엔터티](#%EC%97%94%ED%84%B0%ED%8B%B0)
        - [약한 엔터티와 강한 엔터티](#%EC%95%BD%ED%95%9C-%EC%97%94%ED%84%B0%ED%8B%B0%EC%99%80-%EA%B0%95%ED%95%9C-%EC%97%94%ED%84%B0%ED%8B%B0)
    - [릴레이션](#%EB%A6%B4%EB%A0%88%EC%9D%B4%EC%85%98)
        - [테이블과 컬렉션](#%ED%85%8C%EC%9D%B4%EB%B8%94%EA%B3%BC-%EC%BB%AC%EB%A0%89%EC%85%98)
    - [속성](#%EC%86%8D%EC%84%B1)
    - [도메인](#%EB%8F%84%EB%A9%94%EC%9D%B8)
    - [필드와 레코드](#%ED%95%84%EB%93%9C%EC%99%80-%EB%A0%88%EC%BD%94%EB%93%9C)
        - [필드](#%ED%95%84%EB%93%9C)
        - [레코드](#%EB%A0%88%EC%BD%94%EB%93%9C)
        - [테이블 예시와 MySQL 코드](#%ED%85%8C%EC%9D%B4%EB%B8%94-%EC%98%88%EC%8B%9C%EC%99%80-mysql-%EC%BD%94%EB%93%9C)
    - [관계](#%EA%B4%80%EA%B3%84)
        - [:1 관계](#1-%EA%B4%80%EA%B3%84)
        - [:N 관계](#n-%EA%B4%80%EA%B3%84)
        - [N:M 관계](#nm-%EA%B4%80%EA%B3%84)
    - [키](#%ED%82%A4)
        - [슈퍼키](#%EC%8A%88%ED%8D%BC%ED%82%A4)
        - [후보키](#%ED%9B%84%EB%B3%B4%ED%82%A4)
        - [기본키](#%EA%B8%B0%EB%B3%B8%ED%82%A4)
        - [외래키](#%EC%99%B8%EB%9E%98%ED%82%A4)
        - [대체키](#%EB%8C%80%EC%B2%B4%ED%82%A4)
    - [**참고 자료**](#%EC%B0%B8%EA%B3%A0-%EC%9E%90%EB%A3%8C)

<!-- /TOC -->

---

## 데이터베이스

- 개념
    - 데이터베이스(DB, DataBase)는 일정한 규칙, 혹은 규약을 통해 구조화되어 저장되는 데이터의 모음이다.
- 특징
    - 실시간 접근과 동시 공유가 가능하다.

### DBMS(DataBase)

- 개념
    - 데이터베이스를 제어, 관리하는 통합 시스템이다.
- 특징
    - 각 DBMS마다 정의된 쿼리 언어를 통해 DB 안의 데이터들을 삽입, 삭제, 수정, 조회 등이 가능하다.

### 데이터베이스와 DBMS의 구조

- 구조
    - 데이터베이스 위에 DBMS가 있고, 그 위에 응용 프로그램이 있으며, 이러한 구조를 기반으로 데이터를 주고받는다.
- 예시
    - MySQL 이라는 DBMS 위에 Node.js 나 php 와 같은 응용 프로그램이 있을 수 있다.

## 엔터티

- 개념
    - 사람, 장소, 물건, 사건, 개념 등 여러 개의 속성을 지닌 명사를 의미한다.
- 특징
    - 엔터티의 속성은 서비스의 요구사항에 맞춰서 정해진다.
- 예시
    - 회원이라는 엔터티의 경우 이름, 아이디, 주소, 전화번호 등의 속성을 가질 수 있다.

### 약한 엔터티와 강한 엔터티

- 약한 엔터티
    - 혼자서는 존재하지 못하고 다른 엔터티의 존재 여부에 종속적인 엔터티를 말한다.
- 강한 엔터티
    - 혼자서 존재할 수 있는 엔터티를 말한다.
- 예시
    - 방은 건물 안에만 존재하기 때문에, 방은 약한 엔터티라 할 수 있고 건물은 강한 엔터티라 할 수 있다.

## 릴레이션

- 개념
    - 데이터베이스에서 정보를 구분하여 저장하는 기본 단위를 의미한다.
- 특징
    - 엔터티에 관한 데이터를 데이터베이스는 릴레이션 하나에 담아서 관리한다.
- 예시
    - 회원이라는 엔터티는 데이터베이스에서 관리될 때 릴레이션으로 변화한다.
- 이름
    - **관계형 데이터베이스**에서의 릴레이션은 **테이블**이라고 불린다.
    - **NoSQL 데이터베이스**에서의 릴레이션은 **컬렉션**이라고 불린다.

### 테이블과 컬렉션

- 관계형 데이터 베이스 MySQL의 구조
    - 레코드가 쌓여서 테이블이 되고, 테이블이 쌓여서 데이터베이스가 된다.
- NoSQL 데이터베이스 MongoDB의 구조
    - 도큐먼트가 쌓여서 컬렉션이 되고, 컬렉션이 쌓여서 데이터베이스가 된다.

## 속성

- 개념
    - 릴레이션에서 관리하는 구체적이며 고유한 이름을 갖는 정보이다.
- 특징
    - 서비스의 요구사항을 기반으로 **관리해야 할 필요가 있는 속성들만** 엔터티의 속성이 된다.


## 도메인

- 개념
    - 릴레이션에 포함된 각각의 속성들이 가질 수 있는 값의 집합을 의미한다.
- 예시
    - 성별이라는 속성에 대해서, 이 속성이 가질 수 있는 값은 {남, 여}라는 집합이 된다.


## 필드와 레코드

<img alt="테이블 설명" src="">

### 필드

- 개념
    - DB 테이블에 세로 방향으로 표시된 컬럼을 의미한다.
    - 필드는 **열(=컬럼)** 또는 속성이라고도 불린다.
- 필드 타입
    - 숫자 타입  
        |타입|용량(바이트)|최솟값(부호 O)|최솟값(부호 X)|최댓값(부호 O)|최댓값(부호 X)|
        |--|--|--|--|--|--|
        |TINYINT|1|-128|0|127|255|
        |SMALLINT|2|-32768|0|32767|65535|
        |MEDIUMINT|3|-8388608|0|8388607|16777215|
        |INT|4|-2147483648|0|2147483647|4294967295|
        |BIGINT|8|-263|0|263-1|264-1|

    - 날짜 타입
        - DATE
            - 날짜 부분은 있지만 시간 부분은 없는 값에 사용된다.
            - 지원되는 범위: 1000-01-01 ~ 9999-12-31
            - 용량: 8바이트
        - DATETIME
            - 날짜 및 시간 부분을 모두 포함하는 값에 사용된다.
            - 지원되는 범위: 1000-01-01 00:00:00 ~ 9999-12-31 23:59:59
            - 용량: 4바이트
        - TIMESTAMP
            - 날짜 및 시간 부분을 모두 포함하는 값에 사용된다.
            - 지원되는 범위: 1970-01-01 00:00:01 ~ 2038-01-19 03:14:07
            - 용량: 4바이트
    - 문자 타입
        - CHAR와 VARCHAR
            - 공통점
                - 두 타입 모두 안에 수를 입력해서 몇 자까지 입력할지를 정한다.
            - 차이점
                - **CHAR**의 경우 **고정 길이 문자열**로 길이는 0-255 사이의 값을 가지며, 레코드를 저장할 때 무조건 선언한 길이 값으로 **고정**해서 저장된다.
                - **VARCHAR**의 경우 **가변 길이 문자열**로 길이는 0-65,535 사이의 값을 가지며, 입력된 데이터에 따라 용량을 **가변**시켜 저장한다.
        - TEXT와 BLOB
            - 공통점
                - 두 타입 모두 큰 데이터를 저장할 때 사용한다.
            - 차이점
                - **TEXT**는 큰 문자열을 저장하고, 주로 게시판의 본문을 저장할 때 사용한다.
                - **BLOB**은 이미지, 동영상 등의 큰 데이터를 저장한다. 하지만 보통은 아마존 이미지 호스팅 서비스인 S3를 이용하는 등, 서버에 파일을 올리고, 파일에 관한 경로를 VARCHAR로 저장한다.
        - ENUM과 SET
            - 공통점
                - 두 타입 모두 문자열을 열거한 타입이다.
                - 장점: 공간적으로 이점을 볼 수 있다.
                - 단점: 어플리케이션의 수정에 따라 DB에서 정의한 목록을 수정해야 한다.
            - 차이점
                - **ENUM**은 ENUM('x-small', 'small', 'medium', 'large', 'x-large') 형태로 쓰이며 이 중에서 **하나만 선택**하는 단일 선택만 가능하고, ENUM 리스트에 없는 잘못된 값을 삽입 시 빈 문자열이 대신 삽입된다. ENUM을 이용 시 x-small 등이 0, 1 등으로 매핑되어 메모리를 적게 사용하는 이점을 얻고, 최대 65,535개의 요소들을 넣을 수 있다.
                - **SET**은 ENUM과 비슷하지만 여러 개의 데이터를 선택할 수 있고 비트 단위의 연산을 할 수 있으며 최대 64개의 요소를 넣을 수 있다.


### 레코드

- 개념
    - DB 테이블에 쌓이는 행 단위의 데이터를 의미한다.
    - 레코드는 **튜플**이라고도 불린다.

### 테이블 예시와 MySQL 코드

- '책'이라는 엔터티 정의
    - 속성
        - 이름, 저자의 아이디, 출판년도, 장르, 생성 일시, 업데이트 일시
    - 타입(MySQL 기준)
        - 책의 아이디: INT
        - 책의 제목: VARCHAR(255)
        - 책의 저자 아이디: INT
        - 책의 출판년도: VARCHAR(255)
        - 책의 장르: VARCHAR(255)
        - 생성 일시: DATETIME
        - 업데이트 일시: DATETIME
- 테이블 생성
    - MySQL 코드
        ```sql
        CREATE TABLE book(
            id INT NOT NULL AUTO_INCREMENT,
            title VARCHAR(255),
            author_id INT,
            publishing_year VARCHAR(255),
            genre VARCHAR(255),
            created_at DATETIME,
            updated_at DATETIME,
            PRIMARY KEY (id)
        );
        ```

## 관계

<img alt="관계 화살표" src="">

- 개념
    - 데이터베이스에는 여러 개의 테이블이 있고, 이러한 테이블은 서로의 관계가 정의되어 있다.

### 1:1 관계

- 개념
    - 유저당 유저 이메일은 한 개씩 있는 경우처럼, 1:1로 이뤄지는 관계이다.
- 특징
    - 테이블을 두 개의 테이블로 나눠 테이블의 구조를 더 이해하기 쉽게 만들어준다.

### 1:N 관계

- 개념
    - 한 개체가 다른 많은 개체를 포함하는 관계이다.
- 특징
    - 많은 것이 아니라 0개의 개체를 포함할 수도 있다.

### N:M 관계

- 개념
    - 두 개체가 서로를 포함할 수 있는 관계이다.
- 특징
    - N:M은 테이블 두 개를 직접적으로 연결해서 구축하기보다, 1:N, 1:M 의 관계를 갖는 테이블 두 개로 나누어 설정한다.

## 키

- 개념
    - 테이블 간의 관계를 명확하게 하고 테이블 자체의 인덱스를 위해 설정된 장치이다.
- 구성

    <img alt="키" src="">

    - 슈퍼키는 **유일성**이 있고, 그 안의 후보키는 **최소성**까지 갖춘 키이다.
        > - **유일성**: 하나의 키값으로 튜플을 유일하게 식별할 수 있는 성질을 말한다.
        > - **최소성**: 키를 구성하는 속성들 중 가장 최소로 필요한 속성들로만 키를 구성하는 성질을 말한다

### 슈퍼키

- 개념
    - 유일성은 만족하지만 최소성은 만족하지 않는 키를 의미한다.
- 예시
    - '고객 아이디'의 경우 아이디가 같은 고객은 없기 때문에 슈퍼키가 될 수 있다.
    - '직업, 나이, 등급' 의 경우 같은 고객은 충분히 있을 수 있기 때문에 슈퍼키로 사용할 수 없다.
    - '고객 아이디, 직업, 나이, 등급' 의 경우는 고객 아이디가 각 튜플을 구분할 수 있는 속성이기 때문에 슈퍼키가 될 수 있다.

### 후보키

- 개념
    - 유일성과 최소성을 모두 만족하는 속성 또는 속성들의 집합이다.
- 예시
    - 위의 슈퍼키에서 들었던 예시에서 '고객 아이디, 직업, 나이, 등급' 은 각 튜플을 유일하게 식별할 수 있으므로 유일성은 만족한다.
    - 하지만 여기서 직업, 나이, 등급 정보는 필요하지 않다. 이 속성들은 튜플 간에 중복되는 속성값을 가지고 있고, 이 속성들이 포함되어 있지 않은 '고객 아이디' 만으로도 튜플의 식별에는 전혀 문제가 되지 않는다.
    - 그러므로 위의 키에서 직업, 나이, 등급을 제외한 '고객 아이디'는 최소성을 만족하며 후보키가 될 수 있다.

### 기본키

- 개념
    - 유일성과 최소성을 만족하는 후보키 중에서, **개체 무결성의 두 가지 조건**을 만족하는 키를 말한다.
    > **개체 무결성의 두 가지 조건**  
    > 1. NULL 값을 가질 수 없다.  
    > 2. 기본키로 정의된 속성에는 동일한 값이 중복되어 저장될 수 없다.
- 자연키와 인조키
    - 자연키
        - 중복된 값들을 제외하며 중복되지 않는 것들을 자연스레 뽑다가 나오는 키를 말한다.
        - 자연키는 언젠가 변하는 속성을 가진다.
    - 인조키
        - 인위적으로 부여하는 속성을 통해(ex. 유저 아이디) 인위적으로 생성한 키를 말한다.
        - 자연키와는 대조적으로 변하지 않는다.
        - 보통 기본키는 인조키로 설정한다.

### 외래키

- 개념
    - 다른 테이블의 기본키를 그대로 참조하는 값이다.
- 특징
    - 개체와의 관계를 식별하는 데 사용된다.
    - 중복되어도 괜찮다.

### 대체키

- 개념
    - 후보키가 두 개 이상일 경우 어느 하나를 기본키로 지정하고 남은 키를 말한다.

---

## **참고 자료**

- 관련 서적
    - [면접을 위한 CS 전공지식 노트(주홍철)](https://product.kyobobook.co.kr/detail/S000001834833?utm_source=google&utm_medium=cpc&utm_campaign=googleSearch&gt_network=g&gt_keyword=&gt_target_id=aud-901091942354:dsa-435935280379&gt_campaign_id=9979905549&gt_adgroup_id=132556570510&gad_source=1&gclid=Cj0KCQjwwYSwBhDcARIsAOyL0fhby9LTtW8HLZ5Wg0aW9oKf_EyHPNtAttNCtkeyvmU4HlWw4sGx6VYaAnT5EALw_wcB)
- 이미지 출처
    - [테이블 설명](http://wiki.hash.kr/index.php/%ED%8C%8C%EC%9D%BC:%ED%85%8C%EC%9D%B4%EB%B8%94_%EC%84%A4%EB%AA%85.png)
    - [관계 화살표](https://mjn5027.tistory.com/43)
    - [키](https://ggop-n.tistory.com/78#google_vignette)